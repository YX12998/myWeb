<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<!-- <script type="text/javascript" src="http://api.map.baidu.com/getscript?v=2.0&ak=E4805d16520de693a3fe707cdc962045&services=&t=20190622163250"></script> -->
		<script src="jquery-2.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="http://api.map.baidu.com/library/DistanceTool/1.2/src/DistanceTool_min.js"></script>
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.2"></script>
		<style type="text/css">
			.map01 {
				width: 100%;
				height: 600px;
				border: 1px solid skyblue;
			}

			.oneStudent {
				width: 100px;
				height: 300px;
				position: absolute;
				left: 0;
				top: 0;
				z-index: 999;
				background-image: url(16.png);
			}
		</style>
	</head>
	<body>
		<div class="map01" id="map01"></div>
		<input type="text" id="city" value="" />
		<input type="button" id="bt1" value="开启鼠标测距" /><br>
		1. 一张地图<br>
		2. 地图切换到城市的功能 - input 回车后移动到该城市<br>
		3. 鼠标测距功能 - 要求: 可以反复使用, 测量多条距离<br>
		4. 在地图上画一个坐标点, 用自定义图标替换地图的标记点图标<br>
		5. 点击标记点时有额外信息
	</body>
</html>
<script type="text/javascript">
	$(function() {
		// 地图
		var map = new BMap.Map("map01");
		map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);
		// map.centerAndZoom("南宁");
		map.enableScrollWheelZoom(true);

		// 测距
		var myDis = new BMapLib.DistanceTool(map);
		map.addEventListener("load", function() {
			// myDis.open(); // 开启鼠标测距
			myDis.close();
		});

		// 事件声明的部分

		$("#city").change(function() {
			map.centerAndZoom($(this).val());
		});

		$("#bt1").click(function() {
			myDis.open();
		});
		$("#map01").contextmenu(function() {
			myDis.open();
		});

		// $("#map01").click(function(){
		// 	var y = $(this).offset().top;
		// 	var x = $(this).offset().left;

		// $("#map01").click(function(){
		// 	$("#map01").append("<div class='oneStudent'></div>");
		// 	$(".oneStudent").css({
		// 		left: event.clientX + "px",
		// 		top: event.clientY + "px",
		// 	});
		// });
		// function showInfo(e){
		// 	var pt = new BMap.Point(e.point.lng, e.point.lat);
		// 	var myIcon = new BMap.Icon("16.png", new BMap.Size(200, 457));
		// 	var marker2 = new BMap.Marker(pt, {
		// 		icon: myIcon
		// 	}); // 创建标注
		// 	map.addOverlay(marker2); // 将标注添加到地图中
		// 	marker2.addEventListener('click', function(){
		// 		var lableString = "我的坐标是:"+ e.point.lng + "," + e.point.lat;
		// 		var lable = 
		// 	});
		// }
		// $("#map01").click(function(){
		// 	showInfo($(this));
		// });
		map.addEventListener('click', function showInfo(e) {

			var pt = new BMap.Point(e.point.lng, e.point.lat);
			var myIcon = new BMap.Icon("19.png", new BMap.Size(60, 70));
			var marker2 = new BMap.Marker(pt, {
				icon: myIcon
			}); // 创建标注
			map.addOverlay(marker2); // 将标注添加到地图中


			marker2.addEventListener('click', function(){
				var lableString = "俺的坐标是" + e.point.lng + "," + e.point.lat;
				var label = new BMap.Label(lableString, {
					offset: new BMap.Size(-10, -20)
				})
				marker2.setLabel(label);
				setTimeout(function(){
					label.hide();
				}, 2000)
			})
			marker2.enableDragging();
			map.addOverlay(marker2)
		});






	});
</script>
